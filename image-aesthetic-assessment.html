<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Amit Kushwaha" />
        <meta name="copyright" content="Amit Kushwaha" />

        <meta name="twitter:creator" content="@imYardstick17">
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="image quality prediction using deep learning, spatial pyramid pooling, spp-net, image quality asssessment, Deep Learning, " />

<meta property="og:title" content="Image Aesthetic Assessment "/>
<meta property="og:url" content="https://amitkushwaha.co.in/image-aesthetic-assessment.html" />
<meta property="og:description" content="Image Aesthetic Assessment using Deep Learning. The defined network takes the complete image instead of fixed or re-sized input. This makes the network to learn about original image composition." />
<meta property="og:site_name" content="Connecting Dots" />
<meta property="og:article:author" content="Amit Kushwaha" />
<meta property="og:article:published_time" content="2017-04-01T00:00:00+05:30" />
<meta name="twitter:title" content="Image Aesthetic Assessment ">
<meta name="twitter:description" content="Image Aesthetic Assessment using Deep Learning. The defined network takes the complete image instead of fixed or re-sized input. This makes the network to learn about original image composition.">

        <title>Image Aesthetic Assessment  · Connecting Dots
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://amitkushwaha.co.in/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://amitkushwaha.co.in/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://amitkushwaha.co.in/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://amitkushwaha.co.in/theme/css/custom.css" media="screen">
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-98482392-1', 'auto');
    ga('send', 'pageview');
</script>
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="https://amitkushwaha.co.in/"><span class=site-name>Connecting Dots</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="https://amitkushwaha.co.in">Home</a></li>
                            <li ><a href="https://amitkushwaha.co.in/pages/about-me.html">About me</a></li>
                            <li ><a href="https://amitkushwaha.co.in/categories.html">Categories</a></li>
                            <li ><a href="https://amitkushwaha.co.in/tags.html">Tags</a></li>
                            <li ><a href="https://amitkushwaha.co.in/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="https://amitkushwaha.co.in/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://amitkushwaha.co.in/image-aesthetic-assessment.html"> Image Aesthetic Assessment  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <p><strong><em>"Beauty is really in the eye of the beholder"</em></strong></p>
<p>Image aesthetics assessment is an attempt to define the <strong>beauty</strong> of an Image.
While everyone has different tastes, there are universally accepted norms when it comes to beauty – things which everyone pretty much agrees are beautiful, like sunsets or sunrises over the mountains or the ocean.</p>
<p>Some of the visual features which are generally taken into consideration for an appealing or an unattractive photograph. Some of them are:</p>
<ul>
<li><strong>Edge distributions, Low depth of field,</strong> Images where the subject is in sharp focus while the background is blurred are generally considered aesthetically pleasing. </li>
<li><strong>Color histogram, Opposing colors,</strong> Displaying colors that appear on opposite sides of the color wheel is visually pleasing.</li>
<li>Some photographic rules like <strong>Rule of thirds</strong> also determines the beauty of an image. It states that dividing an image into nine equal parts by drawing two vertical and two horizontal lines should reveal the primary compositional elements near the intersections of the lines.</li>
<li><strong>Salient objects,</strong> Images depicting a large salient object, well separated from the background often have the best composition.</li>
</ul>
<p>Defining image quality with visual features like other manually curated features are limited in the scope.</p>
<p>The two photographer's story.</p>
<table>
<thead>
<tr>
<th>Great Shot!!</th>
<th>So what?</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Beautiful Image" src="./../images/resize_thumb_ambiance_amazing_1024.jpg"></td>
<td><img alt="low quality Image" src="./../images/resize_thumb_ambiance_bad_1024.jpg"></td>
</tr>
</tbody>
</table>
<p>The Image is of the same place taken with different lightning, angle, adjusted contrast. And it is obvious that image on the left has better aesthetic attire.</p>
<p><strong>Significance of Image Aesthetics</strong></p>
<p>For a platform especially that serves media content, one of the crucial aspects is to show high-quality content. With social sites and the given ‘selfie’ trend, we are generating a huge amount of data in the form of either images or videos.
 Having a track on the quality will always be helpful.</p>
<table>
<thead>
<tr>
<th>Curated Content</th>
<th>User Generated Content</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Curated Content" src="./../images/resize_thumb_Screen_Shot_2017_04_15_at_11_18_25_AM_1024.jpg"></td>
<td><img alt="User Generated Content" src="./../images/resize_thumb_Screen_Shot_2017_04_15_at_11_30_00_AM_1024.jpg"></td>
</tr>
</tbody>
</table>
<h2><strong>Can we model such Human Perception?</strong></h2>
<h2><strong>Deep learning</strong></h2>
<p>The topic needs no introduction. It’s a revolution especially in the image classification domain since the last 5 years. With “Alexnet” winning the Image-Net competition, improving error rate with a huge margin acted as a spark in the field. Since then, CNN has many state of the arts on its name.</p>
<p><strong>Network architecture of Alexnet.</strong> </p>
<p><img alt="Alexnet architecture" src="./../images/thumb_CNN_image_1024.jpg"></p>
<p>The first layer is input, where input is fed to the network. We can see their pooling operations, convolution operations finally followed by a fully connected layer 
and final softmax layer so that we get values as the probability for each class we label.</p>
<h2><strong>Fixed size input constraint</strong></h2>
<p>Input Layer   |<br>
  ------------- | -------------
  <img alt="Input Layer" src="./../images/thumb_input_CNN_image_1024.jpg"> | Input image <strong>re-sized to 224 * 224</strong> irrespective of original image shape.</p>
<p>We always resize the input feature vector. If the image is larger, image is cropped 
or pad image if image dimensions are smaller, to get a fixed size input to feed the network</p>
<table>
<thead>
<tr>
<th>The Mountains</th>
<th>Qutub Minar</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Mountains" src="./../images/iceland-blue-lagoon-and-snow-mountains-landscape-header.jpg"></td>
<td><img alt="Qutub Minar" src="./../images/qutub-minar-minaret.jpg"></td>
</tr>
</tbody>
</table>
<p>The above two images are <strong>beautiful in their original aspect ratio.</strong> 
What happens if we re-size the image to a fixed size of 224 * 224? 
Certainly, the image will <strong>loose all it’s original aesthetic value!</strong> 
From Landscape to Squared size. All damage is done. The original image composition is lost when an image is re-sized.</p>
<h2><strong>Demystifying the Network Architecture</strong></h2>
<p><img alt="Network Architecture" src="./../images/thumb_CNN_image_1024.jpg"></p>
<p>Let’s unveil the hidden layers! So, we can see that after the input, there are few layers of <strong>Operations</strong>. 
The operations are either <strong>Max-pooling</strong> or convolving with a filter i.e. <strong>Convolution</strong>.
So why the fixed size of input is required at all then?<br>
It’s because of the <strong>Fully Connected Layer</strong> just before the outputs. 
Fully Connected Layers are in the network for the non-linear combination of feature extracted before in convolution network.</p>
<p>Let's understand bit by bit.</p>
<h2><strong>Max Pooling</strong></h2>
<p>Max pooling are there for <strong>Down-sampling</strong> the feature space while maintaining the spatial information
Max Pooling in action</p>
<p><img alt="Max Pooling" src="./../images/cropped_max_pooling.gif"></p>
<h2><strong>Spatial Pyramid Pooling</strong></h2>
<p>In spp, an image is divided into bins. Each bin is pooled in its turn. As the number of bins is fixed, 
we always get the <strong>Fixed Shape Output</strong>.</p>
<p>Spp operation in action</p>
<p><img alt="Spatial Pyramid Pooling" src="./../images/sppp_2_cropped.gif"></p>
<p><img alt="Spatial Pyramid Pooling" src="./../images/bin_4_spp.gif"></p>
<h2><strong>Spp Network Architecture</strong></h2>
<p><img alt="Spp Network Architecture" src="./../images/network.png"></p>
<p>The first network is the traditional CNN, we can see the <strong>Max-pool layer</strong> just before the fully connected layer.
In the second architecture, the last max pooling layer is <strong>replaced by a Spp layer</strong>. 
With the <strong>Fixed Bin size (1,2,4)</strong> we make sure that the fully connected layer gets the fixed shape input.</p>
<p><img alt="Spp Network Architecture" src="./../images/687474703a2f2f692e696d6775722e636f6d2f5351574a566f442e706e67.png"></p>
<h2><strong>Training the Spp-Net</strong></h2>
<p>Training the Spp-Net on <strong>live-dataset</strong>, very small dataset, about 1K images total, model achieved the accuracy of 75% on training data, 83% of the test data.</p>
<table>
<thead>
<tr>
<th>Accuracy</th>
<th>Training Loss</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Spp-Net Accuracy" src="./../images/training_accuracy.png"></td>
<td><img alt="Spp-Net Training Loss" src="./../images/training_loss.png"></td>
</tr>
</tbody>
</table>
<h2><strong>Takeaways</strong></h2>
<p><strong>With Spp in Network</strong>  </p>
<ul>
<li>Model learns the scale invariant feature like SIFT(traditional image processing algorithm).</li>
<li>One of the challenges in text classification with Deep learning is the fixed size feature vector representation of the sentence.</li>
</ul>
<h2><strong>Interesting Results</strong></h2>
<p>After training model, I experimented with few results. These are the most interesting and promising results I found.</p>
<table>
<thead>
<tr>
<th>Blurred Cropped Image</th>
<th>Complete Image</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Blurred Image" src="./../images/low_quality_blurred_image.jpg"></td>
<td><img alt="Complete Image" src="./../images/high_quality_blurred_image.jpg"></td>
</tr>
</tbody>
</table>
<p>I recently came across a <a href="https://philliphaumesserphotography.com">Photographer</a> experience from being an amateur to professional.<br>
He proved what difference a change in perspective can make. So, I decided to make my trained model judge for his efficacy.</p>
<table>
<thead>
<tr>
<th>Amateur Click? Yes, it is.</th>
<th>Pro Click? I am already amazed.</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Beautiful Image" src="../images/amateur_photographer.png"></td>
<td><img alt="low quality Image" src="../images/professionl_photographer.png"></td>
</tr>
</tbody>
</table>
<p>The aesthetic trained model has passed him with flying colors in Photographic skills. Well done Phillip Haumesser.</p>
<h2><strong>SPP Network</strong></h2>
<p><script src="https://gist.github.com/yardstick17/22c02363c5e04763373b588f1a3bceeb.js"></script></p>
<h2><strong>References</strong></h2>
<ul>
<li><a href="https://arxiv.org/abs/1406.4729">Kaiming He, Xiangyu Zhang, Shaoqing Ren, Jian Sun, Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition</a></li>
<li><a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf">Alex Krizhevsky, Ilya Sutskever, Geoffrey E. Hinton, ImageNet Classification with Deep Convolutional Neural Networks 2012</a></li>
<li><a href="https://ieeexplore.ieee.org/document/7780429/">Long Mai, Hailin Jin, Feing Liu, Composition-Preserving Deep Photo Aesthetics Assessment</a></li>
</ul>
<p>With that, I would like to wrap up. Any Questions?</p>
            
            <section>
<div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2"
                href="https://amitkushwaha.co.in/image-aesthetic-assessment.html#disqus_thread">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="accordion-body collapse">
            <div class="accordion-inner">
                <div class="comments">
                    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'amitkushwaha';
        var disqus_identifier = 'https://amitkushwaha.co.in/image-aesthetic-assessment.html';
    var disqus_url = 'https://amitkushwaha.co.in/image-aesthetic-assessment.html';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                </div>
            </div>
        </div>
    </div>
</div>
</section>

            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2017-04-01T00:00:00+05:30">Apr 1, 2017</time>
            <h4>Category</h4>
            <a class="category-link" href="https://amitkushwaha.co.in/categories.html#deep-learning-ref">Deep Learning</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://amitkushwaha.co.in/tags.html#image-quality-asssessment-ref">image quality asssessment
                    <span>1</span>
</a></li>
                <li><a href="https://amitkushwaha.co.in/tags.html#image-quality-prediction-using-deep-learning-ref">image quality prediction using deep learning
                    <span>1</span>
</a></li>
                <li><a href="https://amitkushwaha.co.in/tags.html#spatial-pyramid-pooling-ref">spatial pyramid pooling
                    <span>1</span>
</a></li>
                <li><a href="https://amitkushwaha.co.in/tags.html#spp-net-ref">spp-net
                    <span>1</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="https://www.linkedin.com/in/yardstick17" title="My linkedin Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-linkedin sidebar-social-links"></i></a>
    <a href="https://github.com/yardstick17" title="My github Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-github sidebar-social-links"></i></a>
    <a href="https://twitter.com/imYardstick17" title="My twitter Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-twitter sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

            <script type="text/javascript">
var disqus_shortname = 'amitkushwaha';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
<script  language="javascript" type="text/javascript">
function uncollapse() {
    if (window.location.hash.match(/^#comment-\d+$/)) {
        $('#disqus_thread').collapse('show');
    }
}
</script>
<script type="text/javascript" language="JavaScript">
uncollapse();
window.onhashchange=function(){
    if (window.location.hash.match(/^#comment-\d+$/))
        window.location.reload(true);
}
</script>
<script>
$('#disqus_thread').on('shown', function () {
    var link = document.getElementsByClassName('accordion-toggle');
    var old_innerHTML = link[0].innerHTML;
    $(link[0]).fadeOut(500, function() {
        $(this).text('Click here to hide comments').fadeIn(500);
    });
    $('#disqus_thread').on('hidden', function () {
        $(link[0]).fadeOut(500, function() {
            $(this).text(old_innerHTML).fadeIn(500);
        });
    })
})
</script>


    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>