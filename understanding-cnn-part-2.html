<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person">
<head>
            <meta charset="utf-8">
        <!-- Site Meta Data -->

        <title> <a href="https://yardstick17.github.io "> Understanding CNN (Part 2) </a>  </title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Amit Kushwaha">

        <link rel="shortcut icon" href="http://localhost:8000/images/favicon.ico">

        <!-- schema.org -->
        <meta itemprop="name" content="Connecting Dots">
        <meta itemprop="image" content="">
        <meta itemprop="description" content="">

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
        <!-- Style Meta Data -->
        <link rel="stylesheet" href="https://yardstick17.github.io/theme/css/style.css" type="text/css"/>
        <link rel="stylesheet" href="https://yardstick17.github.io/theme/css/pygments.css" type="text/css"/>

        <!-- Feed Meta Data -->
            <link href="https://yardstick17.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="Connecting Dots ATOM Feed"/>

        <!-- Twitter Feed -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="imYardstick17">
        <meta name="twitter:image" content="">

    <meta name="twitter:creator" content="imYardstick17">
    <meta name="twitter:url" content="https://yardstick17.github.io/understanding-cnn-part-2.html">
    <meta name="twitter:title" content="Connecting Dots ~ Understanding CNN (Part 2)">
    <meta name="twitter:description" content="This is the continuation of Part-1 of this series. if you are just started in the subject please review the Part-1 of this series. Training Perceptron Dataset X = np.array([[0, 0, 1], [1, 1, 1], [1, 0, 1], [0, 1, 1]]) Y = np.array([0, 1, 1, 0]) We …">

    <!-- Facebook Meta Data -->
    <meta property="og:title" content="Connecting Dots ~ Understanding CNN (Part 2)"/>
    <meta property="og:description" content="This is the continuation of Part-1 of this series. if you are just started in the subject please review the Part-1 of this series. Training Perceptron Dataset X = np.array([[0, 0, 1], [1, 1, 1], [1, 0, 1], [0, 1, 1]]) Y = np.array([0, 1, 1, 0]) We …"/>
    <meta property="og:image" content=""/>
</head>

<body>
<!-- Sidebar -->
<aside>
    <!--<center><a href="https://yardstick17.github.io"><img id="avatar" src=""></a></center>-->
    <h1>Connecting Dots</h1>
        <p>AI | NLP | DEEP LEARNING</p>
    <br>

        <a class="twitter-follow-button"
           href="https://twitter.com/imYardstick17"
           data-show-count="false"
           data-lang="en">
            Follow @twitterdev
        </a>
        <script type="text/javascript">
            window.twttr = (function (d, s, id) {
                var t, js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s);
                js.id = id;
                js.src = "https://platform.twitter.com/widgets.js";
                fjs.parentNode.insertBefore(js, fjs);
                return window.twttr || (t = {
                        _e: [], ready: function (f) {
                            t._e.push(f)
                        }
                    });
            }(document, "script", "twitter-wjs"));
        </script>

    <nav class="nav">
        <ul class="list-bare">

                <li><a class="nav__link" href="https://yardstick17.github.io/pages/about-me.html">About</a></li>
                <li><a class="nav__link" href="https://yardstick17.github.io">Blog</a></li>
                <li><a class="nav__link" href="https://yardstick17.github.io/archives.html">Archive</a></li>
                <li><a class="nav__link" href="https://yardstick17.github.io/categories.html">Categories</a></li>


        </ul>
    </nav>

    <p class="social">
                <a href="https://www.linkedin.com/in/yardstick17" target="_blank"><img
                        src="https://yardstick17.github.io/theme/images/icons/linkedin.png"></a>
                <a href="https://github.com/yardstick17" target="_blank"><img
                        src="https://yardstick17.github.io/theme/images/icons/github.png"></a>
                <a href="https://twitter.com/imYardstick17" target="_blank"><img
                        src="https://yardstick17.github.io/theme/images/icons/twitter.png"></a>
            <a href="https://yardstick17.github.io/feeds/all.atom.xml" rel="alternate">
                <img src="https://yardstick17.github.io/theme/images/icons/rss.png"></a>
    </p>

        <h2>Categories</h2>
        <ul class="navbar">
                <li class="active"><a
                        href="https://yardstick17.github.io/category/deep-learning.html">Deep Learning</a></li>
                <li><a
                        href="https://yardstick17.github.io/category/natural-language-processing.html">Natural Language Processing</a></li>
                <li><a
                        href="https://yardstick17.github.io/category/research-paper-explained.html">Research Paper Explained</a></li>
                <li><a
                        href="https://yardstick17.github.io/category/software-development.html">Software Development</a></li>
        </ul>

    <span>
        <a class="github-button" href="https://github.com/yardstick17"
           aria-label="Follow @yardstick17 on GitHub">Follow @yardstick17</a>
    </span>


</aside>

<!-- Content -->
<article>
    <section id="content">
        <article>

            <h2 class="post_title post_detail" style="color: #1a1a1a"><a href="https://yardstick17.github.io/understanding-cnn-part-2.html"
                                                                         rel="bookmark"
                                                                         title="Permalink to Understanding CNN (Part 2)">Understanding CNN (Part 2)</a>
            </h2>

            <br>
            <div class="entry-content blog-post">
                <p>This is the continuation of Part-1 of this series. if you are just started in the subject please review
the <a href="http://amitkushwaha.co.in/understanding-cnn.html">Part-1</a> of this series.</p>
<h2><strong>Training Perceptron</strong></h2>
<p><img alt="Perceptron" src="../images/TalkCNN.016.jpeg"></p>
<h3>Dataset</h3>
<div class="highlight"><pre><span></span>    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>


<p>We are starting with this truth-table to train our perceptron model.</p>
<p><strong>X</strong>: Feature Vector of each sample</p>
<p><strong>Y</strong>: Label for each sample</p>
<p><img alt="weights-update-process-visualization" src="../images/cnn-weights-update-animation.gif"></p>
<p>We initialize our perceptron model with random values of weights.</p>
<div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>


<p>As explained in the Training Algorithm section, we aim to increase the performance at tasks in T.
In each epoch, we make a feed-forward our perceptron to predict the desired output. When the
predicted(calculated) is not consistent with the desired, we make an update to the weights of perceptron.
 Updating the weights means, wither the values of W are going to be increased or decreaded.
 This delta change is what <strong><em>Training Algorithm</em></strong> dictates in order to minimize the overall error/loss as defined.</p>
<p>While we train any model, we always have a loss defined over which the weights are optimized.
A very typical training loss should appear like this.</p>
<p>Learning rate is the momentum we give to our training speed.</p>
<div class="highlight"><pre><span></span>    <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.001</span>
</pre></div>


<p>In our case we have defined our loss as the squared error. As explained in the previous 
session, the delta weights update formulates to this:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delta_weight</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span> <span class="n">true_label</span><span class="p">,</span> <span class="n">predicted_label</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    :param eta: Learning rate</span>
<span class="sd">    :param true_label:</span>
<span class="sd">    :param predicted_label:</span>
<span class="sd">    :param x:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lambda_param</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">delta_w</span> <span class="o">=</span> <span class="n">lambda_param</span> <span class="o">*</span> <span class="n">eta</span> <span class="o">*</span> <span class="p">(</span><span class="n">predicted_label</span> <span class="o">-</span> <span class="n">true_label</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">delta_w</span>
</pre></div>


<script src="https://gist.github.com/yardstick17/dcf240784bcdf455a534b6d4179cd9c1.js"></script>

<p>So, we have hyper-parameter to choose when we start training a model. In our case, hyper-parameters are:</p>
<div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">eta: learning rate of the training</span>
<span class="sd">lambda_param: to limit the maximum delta change in weights</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>


<p>With different learning rates we may get different loss-plots. If the learning rate is high, weights updates are
large, which <em><strong>may</strong></em> result in faster training.</p>
<p>With Learning Rate,<strong>eta = 0.0001</strong>, the training took more epochs to reach the desired minimum loss.</p>
<p><img alt="Training loss Graph" src="../images/training_loss_e_0.001.png"></p>
<p>When Learning Rate,<strong>eta = 0.01</strong>, training speeds up almost with the factor of 10.</p>
<p><img alt="Training loss Graph" src="../images/training_loss_plot_e_0.01.png"></p>
            </div>

            <div class="post_list">
                <div class="entry-social">

                    <span>
                    <a class="twitter-share-button"
                       href="https://twitter.com/share"
                       data-text="Understanding CNN (Part 2)"
                       data-url="https://yardstick17.github.io/understanding-cnn-part-2.html"
                       data-hashtags=""
                       data-via="imYardstick17"
                    >
                        Tweet
                    </a>
                    </span>
                    <span>
                        <a class="github-button" href="https://github.com/yardstick17"
                           aria-label="Follow @yardstick17 on GitHub">Follow
                        @yardstick17</a>
                    </span>
                </div>

                <span>By </span>
                <a href="https://yardstick17.github.io/author/amit-kushwaha.html">@Amit Kushwaha</a>
                <span> in </span>
                <span class="post_category"><a href="https://yardstick17.github.io/category/deep-learning.html" rel="bookmark"
                                               title="Permalink to Deep Learning">[ Deep Learning ]</a></span>
                <span class="post_date">Thu 01 June 2017</span>
                <div><span>Tags : </span>
                </div>


            </div>

                <div class="comments">
                    <h2>Comments !</h2>
                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_identifier = "understanding-cnn-part-2.html";
                        (function () {
                            var dsq = document.createElement('script');
                            dsq.type = 'text/javascript';
                            dsq.async = true;
                            dsq.src = 'https://amitkushwaha.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] ||
                            document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                </div>
        </article>
    </section>
</article>

<!-- Footer -->
    <footer>
        <p>A boy who always wanted to be a cricketer cracked AIEEE.</p>
    </footer>

    <!-- Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-98482392-1']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
</body>
</html>