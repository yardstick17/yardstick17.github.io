<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person">
<head>
  <meta charset="utf-8">
  <!-- Site Meta Data -->
  <title>Image Quality: Is your click Beautiful?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Amit Kushwaha">

  <link rel="shortcut icon" href="url-to-favicon">

  <!-- schema.org -->
  <meta itemprop="name" content="Connecting Dots">
  <meta itemprop="image" content="">
  <meta itemprop="description" content="">

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
  <!-- Style Meta Data -->
  <link rel="stylesheet" href="https://yardstick17.github.io/theme/css/style.css" type="text/css" />
  <link rel="stylesheet" href="https://yardstick17.github.io/theme/css/pygments.css" type="text/css" />

  <!-- Feed Meta Data -->
    <link href="https://yardstick17.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Connecting Dots ATOM Feed" />

  <!-- Twitter Feed -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="kushwahamit2016">
  <meta name="twitter:image" content="">

<meta name="twitter:creator" content="kushwahamit2016">
<meta name="twitter:url" content="https://yardstick17.github.io/image-quality-is-your-click-beautiful.html">
<meta name="twitter:title" content="Connecting Dots ~ Image Quality: Is your click Beautiful?">
<meta name="twitter:description" content="<p><br></p>
<p><strong><em>'Beauty is really in the eye of the beholder'</em></strong></p>
<p>Image aesthetics assessment is an attempt to define the <strong>beauty</strong> of an Image.
While everyone has different tastes, there are universally accepted norms when it comes to beauty – things which everyone pretty much agrees are beautiful, like sunsets or sunrises over …</p>">

<!-- Facebook Meta Data -->
<meta property="og:title" content="Connecting Dots ~ Image Quality: Is your click Beautiful?" />
<meta property="og:description" content="<p><br></p>
<p><strong><em>'Beauty is really in the eye of the beholder'</em></strong></p>
<p>Image aesthetics assessment is an attempt to define the <strong>beauty</strong> of an Image.
While everyone has different tastes, there are universally accepted norms when it comes to beauty – things which everyone pretty much agrees are beautiful, like sunsets or sunrises over …</p>" />
<meta property="og:image" content="" />
</head>

<body>
  <!-- Sidebar -->
  <aside>
    <!--<center><a href="https://yardstick17.github.io"><img id="avatar" src=""></a></center>-->
    <h1>Connecting Dots</h1>
      <p>Machine Learning Engineer</p>
    <br>

      <a class="twitter-follow-button"
      href="https://twitter.com/kushwahamit2016"
      data-show-count="false"
      data-lang="en">
      Follow @twitterdev
      </a>
      <script type="text/javascript">
      window.twttr = (function (d, s, id) {
        var t, js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src= "https://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);
        return window.twttr || (t = { _e: [], ready: function (f) { t._e.push(f) } });
      }(document, "script", "twitter-wjs"));
      </script>

    <nav class="nav">
      <ul class="list-bare">
      
          <li><a class="nav__link" href="https://yardstick17.github.io//pages/about-me.html">About</a></li>
          <li><a class="nav__link" href="https://yardstick17.github.io/">Blog</a></li>
         
         
      </ul>
    </nav>

    <p class="social">
        <a href="https://www.linkedin.com/in/yardstick17" target="_blank" ><img src="https://yardstick17.github.io/theme/images/icons/linkedin.png"></a>
        <a href="https://github.com/yardstick17" target="_blank" ><img src="https://yardstick17.github.io/theme/images/icons/github.png"></a>
        <a href="https://twitter.com/kushwahamit2016" target="_blank" ><img src="https://yardstick17.github.io/theme/images/icons/twitter.png"></a>
      <a href="https://yardstick17.github.io/feeds/all.atom.xml" rel="alternate">
        <img src="https://yardstick17.github.io/theme/images/icons/rss.png"></a>
    </p>

    <!--
    <h2>Categories</h2>
    <ul class="navbar">
      <li class="active"><a href="https://yardstick17.github.io/category/deep-learning-artificial-intelligence.html">Deep Learning, Artificial Intelligence</a></li>
      <li><a href="https://yardstick17.github.io/category/natural-language-processing.html">Natural Language Processing</a></li>
      <li><a href="https://yardstick17.github.io/category/software-development.html">Software Development</a></li>
    </ul> 
    -->
  </aside>

  <!-- Content -->
  <article>
<section id="content">
    <article>
        <h2 class="post_title post_detail"><a href="https://yardstick17.github.io/image-quality-is-your-click-beautiful.html" rel="bookmark" title="Permalink to Image Quality: Is your click Beautiful?">Image Quality: Is your click Beautiful?</a></h2>
        <div class="entry-content blog-post">
            <p><br></p>
<p><strong><em>'Beauty is really in the eye of the beholder'</em></strong></p>
<p>Image aesthetics assessment is an attempt to define the <strong>beauty</strong> of an Image.
While everyone has different tastes, there are universally accepted norms when it comes to beauty – things which everyone pretty much agrees are beautiful, like sunsets or sunrises over the mountains or the ocean.</p>
<p><img alt="Foo" src="https://usatunofficial.files.wordpress.com/2012/03/barns_grand_tetons.jpg"></p>
<p>Some of the visual feature that come handy are </p>
<ul>
<li>edge distributions, </li>
<li>color histogram, </li>
<li>Some photographic rules like rue of thirds also determines the beauty of an image.</li>
</ul>
<p><em>Defining image quality with visual features like other manually curated features are limited in the scope.</em></p>
<p><br></p>
<p>The two photographer's story.</p>
<table>
<thead>
<tr>
<th>Great Shot!!</th>
<th>So what?</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Foo" src="https://image.ibb.co/eVhL0k/resize_thumb_ambiance_amazing_1024.jpg"></td>
<td><img alt="Foo" src="https://image.ibb.co/ittcfk/resize_thumb_ambiance_bad_1024.jpg"></td>
</tr>
</tbody>
</table>
<p>The Image is of same place taken with different lightening, angle, adjusted contrast. And it is obvious that image on the left has better aesthetic attire.</p>
<p><br></p>
<p><strong>Significance of Image Aesthetics</strong></p>
<p>For a platform especially that serves media content, one of the crucial aspect is to show high quality content. With social sites and the given ‘selfie’ trend, we are generating huge amount of data in the form of either imaages or videos.
 Having a track on the quality will always be helpful.</p>
<table>
<thead>
<tr>
<th>Fine Curated Content</th>
<th>User Generated Content</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Foo" src="https://image.ibb.co/fwvb6Q/resize_thumb_Screen_Shot_2017_04_15_at_11_18_25_AM_1024.jpg"></td>
<td><img alt="Foo" src="https://image.ibb.co/kThTLk/resize_thumb_Screen_Shot_2017_04_15_at_11_30_00_AM_1024.jpg"></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2><strong>Can we model such Human Perception?</strong></h2>
<p><br></p>
<h2><strong>Deep learning</strong></h2>
<p>The topic needs no introduction. It’s a revolution especially in the image classification domain since the last 5 years. With “Alexnet” winning the Image-Net competition, improving error rate with a huge margin acted as spark in the field. Since then, CNN has many state of the arts on its name.</p>
<p><strong>Network architecture of Alexnet.</strong> </p>
<p><img alt="Foo" src="https://image.ibb.co/cG4sfk/thumb_CNN_image_1024.jpg"></p>
<p>The first layer is input, where input in fed to the network. We can see there pooling operations, convolution operations finally followed by a fully connected layer 
and final softmax layer so that we get values as the probability for each class we label.</p>
<p><br></p>
<h2><strong>Fixed size input constraint</strong></h2>
<table>
<thead>
<tr>
<th>Input Layer</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Foo" src="https://image.ibb.co/mMhFi5/thumb_input_CNN_image_1024.jpg"></td>
<td>Input image <strong>re-sized to 224 * 224</strong> irrespective of original image shape.</td>
</tr>
</tbody>
</table>
<p>We always resize the input feature vector. If the image is larger, image is cropped 
or pad image if image dimensions are smaller, to get a fixed size input to fed the network</p>
<table>
<thead>
<tr>
<th>The Mountains</th>
<th>Qutub Minar</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Foo" src="https://www.freewebheaders.com/wordpress/wp-content/gallery/beautiful-landscape/iceland-blue-lagoon-and-snow-mountains-landscape-header.jpg"></td>
<td><img alt="Foo" src="http://images.mapsofindia.com/india-tour/newvolume/mapindia/india-tour/wp-content/blogs.dir/6/files/2012/09/qutub-minar-minaret.jpg"></td>
</tr>
</tbody>
</table>
<p>The above two images are <strong>beautiful in their original aspect ratio.</strong> 
What happens if we re-size the image to a fixed size of 224 * 224? 
Certainly the image will <strong>loose all it’s original aesthetic value!</strong> 
From Landscape to Squared size. All damage is done. The original image composition is lost when image is re-sized.</p>
<p><br></p>
<h2><strong>Demystifying the Network Architecture</strong></h2>
<p><img alt="Foo" src="https://image.ibb.co/cG4sfk/thumb_CNN_image_1024.jpg"></p>
<p>Let’s unveil the hidden layers! So, we can see that after the input , there are few layers of <strong>Operations</strong>. 
The operations are either <strong>Max-pooling</strong> or convolving with a filter i.e. <strong>Convolution</strong>.
So why fixed size of input is required at all then?<br>
It’s because of the <strong>Fully Connected Layer</strong> just before the outputs. 
Fully Connected Layers are in the network for non-linear combination of feature extracted before in convolution network.</p>
<p>Let's understanding bit by bit.</p>
<p><br></p>
<h2><strong>Max Pooling</strong></h2>
<p>Max pooling are there for <strong>Down-sampling</strong> the feature space while maintain the spatial information
Max Pooling in action</p>
<p><img alt="" src="https://image.ibb.co/jKK0GQ/cropped_max_pooling.gif"></p>
<p><br></p>
<h2><strong>Spatial Pyramid Pooling</strong></h2>
<p>In spp, an image is divided into bins. Each bin is pooled in its turn. As the number of bins are fixed, 
we always get the <strong>Fixed Shape Output</strong>.</p>
<p>Spp operation in action</p>
<p><img alt="" src="https://image.ibb.co/juAki5/sppp_2_cropped.gif"></p>
<p><img alt="" src="https://image.ibb.co/f77y35/bin_4_spp.gif"></p>
<p><br></p>
<h2><strong>Spp Network Architecture</strong></h2>
<p><img alt="" src="https://image.ibb.co/fxiPAk/network.png"></p>
<p>The first network is the traditional CNN , we can see the <strong>Max-pool layer</strong> just before the fully connected layer.
In the second architecture, the last max pooling layer is <strong>replaced by a Spp layer</strong>. 
With the <strong>Fixed Bin size (1,2,4)</strong> we make sure that the fully connected layer gets the fixed shape input.</p>
<p><img alt="" src="https://camo.githubusercontent.com/9099d29d9e59248dff137dd10189e0c81d35aa56/687474703a2f2f692e696d6775722e636f6d2f5351574a566f442e706e67"></p>
<p><br></p>
<h2><strong>Training the Spp-Net</strong></h2>
<p>Training the Spp-Net on <strong>live-dataset</strong>, very small dataset, about 1K images total, model achieved the accuracy of 75% on training data, 83% on the test data.</p>
<table>
<thead>
<tr>
<th>Accuracy</th>
<th>Training Loss</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Foo" src="https://image.ibb.co/m9AAi5/training_accuracy.png"></td>
<td><img alt="Foo" src="https://image.ibb.co/fkS1qk/training_loss.png"></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2><strong>Takeaways</strong></h2>
<p><strong>With Spp in Network</strong>  </p>
<ul>
<li>Model learns the scale invariant feature like SIFT(traditional image processing algorithm).</li>
<li>One of the challenge in text classification with Deep learning is the fixed size feature vector representation of sentence.</li>
</ul>
<p><br></p>
<h2><strong>Interesting Results</strong></h2>
<p><br></p>
<table>
<thead>
<tr>
<th>Blurred Cropped Image, Model predicted <strong>high score of 0.46</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Foo" src="https://image.ibb.co/nqyrqk/Screen_Shot_2017_04_25_at_2_48_51_PM.png"></td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<table>
<thead>
<tr>
<th>Complete Image, Model predicted <strong>high score of 0.94</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="Foo" src="https://image.ibb.co/fR5zbQ/blurred_0071.jpg"></td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2><strong>References</strong></h2>
<ul>
<li><a href="https://arxiv.org/abs/1406.4729">Kaiming He, Xiangyu Zhang, Shaoqing Ren, Jian Sun, Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition</a></li>
<li><a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf">Alex Krizhevsky, Ilya Sutskever, Geoffrey E. Hinton, ImageNet Classification with Deep Convolutional Neural Networks 2012</a></li>
<li><a href="https://ieeexplore.ieee.org/document/7780429/">Long Mai, Hailin Jin, Feing Liu, Composition-Preserving Deep Photo Aesthetics Assessment</a></li>
</ul>
<p>With that I would like to wrap up. Any Questions ?</p>
        </div>
        <div class="post_list">
            <span>By </span>
            <a href="https://yardstick17.github.io/author/amit-kushwaha.html">@Amit Kushwaha</a>
            <span> in </span>
            <span class="post_category"><a href="https://yardstick17.github.io/category/deep-learning-artificial-intelligence.html" rel="bookmark" title="Permalink to Deep Learning, Artificial Intelligence">[ Deep Learning, Artificial Intelligence ]</a></span>
            <span class="post_date">Mon 01 May 2017</span>
            <div><span>Tags : </span>
            </div>

            <div class="entry-social">
                <span class="twitter"><a target="_blank" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;" title="Twitter" href="https://twitter.com/share?url=https://yardstick17.github.io/image-quality-is-your-click-beautiful.html&text=Image Quality: Is your click Beautiful?&via=kushwahamit2016"><img src="https://yardstick17.github.io/theme/images/icons/twitter-s.png"></a></span>

                <span class="gplus"><a target="_blank" title="Google +" href="https://plus.google.com/share?url=https://yardstick17.github.io/image-quality-is-your-click-beautiful.html&hl=fr" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img src="https://yardstick17.github.io/theme/images/icons/google-s.png"></a></span>

                <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;" href="https://www.facebook.com/sharer.php?u=https://yardstick17.github.io/image-quality-is-your-click-beautiful.html&t=Image Quality: Is your click Beautiful?"><img src="https://yardstick17.github.io/theme/images/icons/facebook-s.png"></a></span>

                <a  target="_blank" title="Linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://yardstick17.github.io/image-quality-is-your-click-beautiful.html&title=Image Quality: Is your click Beautiful?" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img src="https://yardstick17.github.io/theme/images/icons/linkedin-s.png"></a>

                <span class="mail"><a href="mailto:?subject=Image Quality: Is your click Beautiful?&amp;body=Viens découvrir un article à propos de [Image Quality: Is your click Beautiful?] sur le site de Amit Kushwaha. https://yardstick17.github.io/image-quality-is-your-click-beautiful.html" title="Share by Email" target="_blank"><img src="https://yardstick17.github.io/theme/images/icons/mail-s.png"></a></span>
            </div>
        </div>
        <div class="comments">
            <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
            var disqus_identifier = "image-quality-is-your-click-beautiful.html";
            (function() {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://amitkushwaha.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] ||
                 document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
            </script>
        </div>
    </article>
</section>
  </article>

  <!-- Footer -->
  <footer>
    <p>
      Blog powered by <a href="http://getpelican.com/">Pelican</a>, 
      which takes great advantage of <a href="http://python.org">Python</a>.
      Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a href="https://parbhatpuri.com/">@parbhat</a>.
    </p>
  </footer>

  <!-- Analytics -->
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-98482392-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>

</body>
</html>